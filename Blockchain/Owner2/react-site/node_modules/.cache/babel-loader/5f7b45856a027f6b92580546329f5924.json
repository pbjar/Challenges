{"ast":null,"code":"import _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport { difference, replaceAt } from './utils';\nimport { notifyManager } from './notifyManager';\nimport { QueryObserver } from './queryObserver';\nimport { Subscribable } from './subscribable';\nexport var QueriesObserver = /*#__PURE__*/function (_Subscribable) {\n  _inheritsLoose(QueriesObserver, _Subscribable);\n\n  function QueriesObserver(client, queries) {\n    var _this;\n\n    _this = _Subscribable.call(this) || this;\n    _this.client = client;\n    _this.queries = [];\n    _this.result = [];\n    _this.observers = [];\n    _this.observersMap = {};\n\n    if (queries) {\n      _this.setQueries(queries);\n    }\n\n    return _this;\n  }\n\n  var _proto = QueriesObserver.prototype;\n\n  _proto.onSubscribe = function onSubscribe() {\n    var _this2 = this;\n\n    if (this.listeners.length === 1) {\n      this.observers.forEach(function (observer) {\n        observer.subscribe(function (result) {\n          _this2.onUpdate(observer, result);\n        });\n      });\n    }\n  };\n\n  _proto.onUnsubscribe = function onUnsubscribe() {\n    if (!this.listeners.length) {\n      this.destroy();\n    }\n  };\n\n  _proto.destroy = function destroy() {\n    this.listeners = [];\n    this.observers.forEach(function (observer) {\n      observer.destroy();\n    });\n  };\n\n  _proto.setQueries = function setQueries(queries, notifyOptions) {\n    this.queries = queries;\n    this.updateObservers(notifyOptions);\n  };\n\n  _proto.getCurrentResult = function getCurrentResult() {\n    return this.result;\n  };\n\n  _proto.getOptimisticResult = function getOptimisticResult(queries) {\n    var _this3 = this;\n\n    return queries.map(function (options, index) {\n      var defaultedOptions = _this3.client.defaultQueryObserverOptions(options);\n\n      return _this3.getObserver(defaultedOptions, index).getOptimisticResult(defaultedOptions);\n    });\n  };\n\n  _proto.getObserver = function getObserver(options, index) {\n    var _currentObserver;\n\n    var defaultedOptions = this.client.defaultQueryObserverOptions(options);\n    var currentObserver = this.observersMap[defaultedOptions.queryHash];\n\n    if (!currentObserver && defaultedOptions.keepPreviousData) {\n      currentObserver = this.observers[index];\n    }\n\n    return (_currentObserver = currentObserver) != null ? _currentObserver : new QueryObserver(this.client, defaultedOptions);\n  };\n\n  _proto.updateObservers = function updateObservers(notifyOptions) {\n    var _this4 = this;\n\n    notifyManager.batch(function () {\n      var hasIndexChange = false;\n      var prevObservers = _this4.observers;\n      var prevObserversMap = _this4.observersMap;\n      var newResult = [];\n      var newObservers = [];\n      var newObserversMap = {};\n\n      _this4.queries.forEach(function (options, i) {\n        var defaultedOptions = _this4.client.defaultQueryObserverOptions(options);\n\n        var queryHash = defaultedOptions.queryHash;\n\n        var observer = _this4.getObserver(defaultedOptions, i);\n\n        if (prevObserversMap[queryHash] || defaultedOptions.keepPreviousData) {\n          observer.setOptions(defaultedOptions, notifyOptions);\n        }\n\n        if (observer !== prevObservers[i]) {\n          hasIndexChange = true;\n        }\n\n        newObservers.push(observer);\n        newResult.push(observer.getCurrentResult());\n        newObserversMap[queryHash] = observer;\n      });\n\n      if (prevObservers.length === newObservers.length && !hasIndexChange) {\n        return;\n      }\n\n      _this4.observers = newObservers;\n      _this4.observersMap = newObserversMap;\n      _this4.result = newResult;\n\n      if (!_this4.hasListeners()) {\n        return;\n      }\n\n      difference(prevObservers, newObservers).forEach(function (observer) {\n        observer.destroy();\n      });\n      difference(newObservers, prevObservers).forEach(function (observer) {\n        observer.subscribe(function (result) {\n          _this4.onUpdate(observer, result);\n        });\n      });\n\n      _this4.notify();\n    });\n  };\n\n  _proto.onUpdate = function onUpdate(observer, result) {\n    var index = this.observers.indexOf(observer);\n\n    if (index !== -1) {\n      this.result = replaceAt(this.result, index, result);\n      this.notify();\n    }\n  };\n\n  _proto.notify = function notify() {\n    var _this5 = this;\n\n    notifyManager.batch(function () {\n      _this5.listeners.forEach(function (listener) {\n        listener(_this5.result);\n      });\n    });\n  };\n\n  return QueriesObserver;\n}(Subscribable);","map":{"version":3,"sources":["/home/mark/Desktop/Challenges/Blockchain/Owner2/react-site/node_modules/react-query/es/core/queriesObserver.js"],"names":["_inheritsLoose","difference","replaceAt","notifyManager","QueryObserver","Subscribable","QueriesObserver","_Subscribable","client","queries","_this","call","result","observers","observersMap","setQueries","_proto","prototype","onSubscribe","_this2","listeners","length","forEach","observer","subscribe","onUpdate","onUnsubscribe","destroy","notifyOptions","updateObservers","getCurrentResult","getOptimisticResult","_this3","map","options","index","defaultedOptions","defaultQueryObserverOptions","getObserver","_currentObserver","currentObserver","queryHash","keepPreviousData","_this4","batch","hasIndexChange","prevObservers","prevObserversMap","newResult","newObservers","newObserversMap","i","setOptions","push","hasListeners","notify","indexOf","_this5","listener"],"mappings":"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","sourcesContent":["import _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport { difference, replaceAt } from './utils';\nimport { notifyManager } from './notifyManager';\nimport { QueryObserver } from './queryObserver';\nimport { Subscribable } from './subscribable';\nexport var QueriesObserver = /*#__PURE__*/function (_Subscribable) {\n  _inheritsLoose(QueriesObserver, _Subscribable);\n\n  function QueriesObserver(client, queries) {\n    var _this;\n\n    _this = _Subscribable.call(this) || this;\n    _this.client = client;\n    _this.queries = [];\n    _this.result = [];\n    _this.observers = [];\n    _this.observersMap = {};\n\n    if (queries) {\n      _this.setQueries(queries);\n    }\n\n    return _this;\n  }\n\n  var _proto = QueriesObserver.prototype;\n\n  _proto.onSubscribe = function onSubscribe() {\n    var _this2 = this;\n\n    if (this.listeners.length === 1) {\n      this.observers.forEach(function (observer) {\n        observer.subscribe(function (result) {\n          _this2.onUpdate(observer, result);\n        });\n      });\n    }\n  };\n\n  _proto.onUnsubscribe = function onUnsubscribe() {\n    if (!this.listeners.length) {\n      this.destroy();\n    }\n  };\n\n  _proto.destroy = function destroy() {\n    this.listeners = [];\n    this.observers.forEach(function (observer) {\n      observer.destroy();\n    });\n  };\n\n  _proto.setQueries = function setQueries(queries, notifyOptions) {\n    this.queries = queries;\n    this.updateObservers(notifyOptions);\n  };\n\n  _proto.getCurrentResult = function getCurrentResult() {\n    return this.result;\n  };\n\n  _proto.getOptimisticResult = function getOptimisticResult(queries) {\n    var _this3 = this;\n\n    return queries.map(function (options, index) {\n      var defaultedOptions = _this3.client.defaultQueryObserverOptions(options);\n\n      return _this3.getObserver(defaultedOptions, index).getOptimisticResult(defaultedOptions);\n    });\n  };\n\n  _proto.getObserver = function getObserver(options, index) {\n    var _currentObserver;\n\n    var defaultedOptions = this.client.defaultQueryObserverOptions(options);\n    var currentObserver = this.observersMap[defaultedOptions.queryHash];\n\n    if (!currentObserver && defaultedOptions.keepPreviousData) {\n      currentObserver = this.observers[index];\n    }\n\n    return (_currentObserver = currentObserver) != null ? _currentObserver : new QueryObserver(this.client, defaultedOptions);\n  };\n\n  _proto.updateObservers = function updateObservers(notifyOptions) {\n    var _this4 = this;\n\n    notifyManager.batch(function () {\n      var hasIndexChange = false;\n      var prevObservers = _this4.observers;\n      var prevObserversMap = _this4.observersMap;\n      var newResult = [];\n      var newObservers = [];\n      var newObserversMap = {};\n\n      _this4.queries.forEach(function (options, i) {\n        var defaultedOptions = _this4.client.defaultQueryObserverOptions(options);\n\n        var queryHash = defaultedOptions.queryHash;\n\n        var observer = _this4.getObserver(defaultedOptions, i);\n\n        if (prevObserversMap[queryHash] || defaultedOptions.keepPreviousData) {\n          observer.setOptions(defaultedOptions, notifyOptions);\n        }\n\n        if (observer !== prevObservers[i]) {\n          hasIndexChange = true;\n        }\n\n        newObservers.push(observer);\n        newResult.push(observer.getCurrentResult());\n        newObserversMap[queryHash] = observer;\n      });\n\n      if (prevObservers.length === newObservers.length && !hasIndexChange) {\n        return;\n      }\n\n      _this4.observers = newObservers;\n      _this4.observersMap = newObserversMap;\n      _this4.result = newResult;\n\n      if (!_this4.hasListeners()) {\n        return;\n      }\n\n      difference(prevObservers, newObservers).forEach(function (observer) {\n        observer.destroy();\n      });\n      difference(newObservers, prevObservers).forEach(function (observer) {\n        observer.subscribe(function (result) {\n          _this4.onUpdate(observer, result);\n        });\n      });\n\n      _this4.notify();\n    });\n  };\n\n  _proto.onUpdate = function onUpdate(observer, result) {\n    var index = this.observers.indexOf(observer);\n\n    if (index !== -1) {\n      this.result = replaceAt(this.result, index, result);\n      this.notify();\n    }\n  };\n\n  _proto.notify = function notify() {\n    var _this5 = this;\n\n    notifyManager.batch(function () {\n      _this5.listeners.forEach(function (listener) {\n        listener(_this5.result);\n      });\n    });\n  };\n\n  return QueriesObserver;\n}(Subscribable);"]},"metadata":{},"sourceType":"module"}